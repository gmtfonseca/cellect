<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    table, th, td {
      border: 1px solid black;
    }

    .table {
      width: 500px;
    }

    #total {
      margin-top: 10px;
    }

    .selected {
      background: red;
    }


  </style>
</head>
<body>
  <table class="table">
    <thead>
      <th>Name</th>
      <th>Value</th>
      <th>Total</th>
    </thead>
    <tbody>
      <tr>
        <td>Guto</td>
        <td>10</td>
        <td>11</td>
      </tr>
      <tr>
        <td>Marcos</td>
        <td>5.5</td>
        <td>6</td>
      </tr>
      <tr>
        <td>Claudete</td>
        <td>20</td>
        <td>21</td>
      </tr>
      <tr>
        <td>Pai</td>
        <td>30</td>
        <td>31</td>
      </tr>
      <tr>
        <td>Mae</td>
        <td>120</td>
        <td>121</td>
      </tr>
      <tr>
        <td>Carol</td>
        <td>10.5</td>
        <td>122</td>
      </tr>
    </tbody>
  </table>


  <div id="total">
    <span>Total: </span>
    <span class="total__value"></span>
  </div>

  <script>
    var cells = document.querySelectorAll("td");
    var totalElement = document.getElementById('total')
    var selectKey = 17
    var selectKeyDown = false
    var selected = new Map()
    var hoveredCell = null


    window.onkeydown = function (e) {         
      if (e.keyCode === selectKey) {
        selectKeyDown = true
      }      
      updateCursor()
    }

    window.onkeyup = function (e) {
      if (e.keyCode === selectKey) {
        selectKeyDown = false
      }
      updateCursor()
    }

    window.onmouseover = function(e) {      
      hoveredCell = e.target      
      updateCursor()
    }

    cells.forEach(cell => {  
      cell.addEventListener("click", function () {
        
        if (selectKeyDown) {        
          const row = cell.closest('tr').rowIndex - 1
          const col = this.cellIndex                
          const cellIdx = `${row}:${col}`

          const value = Number(this.innerHTML.trim())

          if (!Number.isNaN(value)) {
            if (selected.has(cellIdx)) {
              selected.delete(cellIdx)
            } else {          
              selected.set(cellIdx, Number(this.innerHTML.trim()))    
            }        
            this.classList.toggle("selected");      
            console.log(selected);
            totalElement.innerHTML = Array.from(selected.values()).reduce((prev, curr) => prev + curr, 0) 
          }

        }                               
      }, false)
    })  

    function updateCursor() {
      if (hoveredCell.tagName === 'TD' && selectKeyDown) {        
        hoveredCell.style.cursor = 'pointer'
      } else {
        hoveredCell.style.cursor = 'default'
      }      
    }        


  </script>
</body>
</html>